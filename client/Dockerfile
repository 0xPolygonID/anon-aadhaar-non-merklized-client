FROM node:21
RUN apt-get update ; apt-get install -y netcat-openbsd

WORKDIR /app

ARG NEXT_PUBLIC_ISSUER_URL
ARG NEXT_PUBLIC_NULLIFIER_SEED
RUN echo "NEXT_PUBLIC_ISSUER_URL: $NEXT_PUBLIC_ISSUER_URL"
RUN echo "NEXT_PUBLIC_NULLIFIER_SEED: $NEXT_PUBLIC_NULLIFIER_SEED"

COPY package*.json ./

RUN npm install

COPY . .

RUN NEXT_PUBLIC_ISSUER_URL=$NEXT_PUBLIC_ISSUER_URL NEXT_PUBLIC_NULLIFIER_SEED=$NEXT_PUBLIC_NULLIFIER_SEED npm run build

CMD ["npm", "start"]
